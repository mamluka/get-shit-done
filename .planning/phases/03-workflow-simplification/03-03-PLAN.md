---
phase: 03-workflow-simplification
plan: 03
type: execute
wave: 2
depends_on: ["03-01", "03-02"]
files_modified:
  - .claude/commands/gsd/edit-phase.md
  - .claude/get-shit-done/workflows/edit-phase.md
  - .claude/get-shit-done/workflows/help.md
  - .claude/get-shit-done/workflows/plan-phase.md
  - .claude/get-shit-done/bin/gsd-tools.js
autonomous: true

must_haves:
  truths:
    - "PM can run /gsd:edit-phase {N} to revise planning artifacts for any phase"
    - "Edit-phase presents available artifacts (plans, research, context) and routes to appropriate editing flow"
    - "Help command shows planning-only workflow without execution references"
    - "Plan-phase next-steps reference /gsd:complete-phase instead of /gsd:execute-phase"
    - "gsd-tools.js init command list no longer includes execute-phase or verify-work"
  artifacts:
    - path: ".claude/commands/gsd/edit-phase.md"
      provides: "Slash command entry point for /gsd:edit-phase"
      contains: "edit-phase"
    - path: ".claude/get-shit-done/workflows/edit-phase.md"
      provides: "Workflow for artifact-aware editing with routing logic"
      contains: "artifact"
    - path: ".claude/get-shit-done/workflows/help.md"
      provides: "Updated help reference with planning-only commands"
      contains: "complete-phase"
  key_links:
    - from: ".claude/commands/gsd/edit-phase.md"
      to: ".claude/get-shit-done/workflows/edit-phase.md"
      via: "@reference in execution_context"
      pattern: "workflows/edit-phase"
    - from: ".claude/get-shit-done/workflows/edit-phase.md"
      to: ".claude/get-shit-done/bin/gsd-tools.js"
      via: "node gsd-tools.js init plan-phase for phase context"
      pattern: "gsd-tools.js"
    - from: ".claude/get-shit-done/workflows/help.md"
      to: "/gsd:complete-phase"
      via: "command reference listing"
      pattern: "complete-phase"
---

<objective>
Create the edit-phase command for artifact revision and update all cross-references to reflect the planning-only workflow.

Purpose: WKFL-05 requires PMs can revise planning artifacts via `/gsd:edit-phase {N}`. Additionally, after Plans 01 and 02 have tombstoned execution and added complete-phase, all remaining cross-references in help, plan-phase, and gsd-tools.js need updating to present a consistent planning-only experience.

Output: New /gsd:edit-phase command + workflow, updated help workflow, updated plan-phase references, cleaned gsd-tools.js init references.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-workflow-simplification/03-RESEARCH.md
@.planning/phases/03-workflow-simplification/03-01-SUMMARY.md
@.planning/phases/03-workflow-simplification/03-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create edit-phase command and workflow</name>
  <files>
    .claude/commands/gsd/edit-phase.md
    .claude/get-shit-done/workflows/edit-phase.md
  </files>
  <action>
    **Create .claude/commands/gsd/edit-phase.md:**

    Follow existing command patterns (discuss-phase.md is a good model). The command should:
    - Name: `gsd:edit-phase`
    - Description: "Revise planning artifacts (plans, research, context) for a phase"
    - Argument-hint: "{phase-number} [artifact-type]"
    - Allowed-tools: Read, Write, Edit, Glob, Grep, Bash, Task
    - Objective: Allow PMs to revise any planning artifact for a given phase. Routes to appropriate editing flow based on artifact type.
    - execution_context: reference @./.claude/get-shit-done/workflows/edit-phase.md
    - context: $ARGUMENTS for phase number and optional artifact type, @.planning/ROADMAP.md, @.planning/STATE.md
    - process: Execute the edit-phase workflow end-to-end

    **Create .claude/get-shit-done/workflows/edit-phase.md:**

    The workflow should implement artifact-aware edit routing (Pattern 3 from research):

    Step 1 - Initialize: Run `node ./.claude/get-shit-done/bin/gsd-tools.js init plan-phase {N} --raw` to get phase context. Parse phase_dir, phase_number, has_research, has_context, has_plans, plan_count.

    Step 2 - Discover artifacts: List what exists in the phase directory:
    - Plans: `{phase_dir}/*-PLAN.md` files
    - Research: `{phase_dir}/*-RESEARCH.md`
    - Context: `{phase_dir}/*-CONTEXT.md`
    - Summaries: `{phase_dir}/*-SUMMARY.md` (read-only reference, not directly editable)

    Step 3 - Determine edit target:
    If artifact type was provided in arguments (e.g., "plan", "research", "context"):
    - Route directly to that artifact type
    If no artifact type specified:
    - Present a menu of available artifacts with descriptions:
      - "plan" — Revise task breakdown, actions, verification criteria
      - "research" — Update domain research with new findings
      - "context" — Revise phase scope and user decisions
      - "roadmap" — Edit phase goal, success criteria, or requirements mapping
    - Ask user which to edit

    Step 4 - Route to editing flow:
    - **plan**: Load the specific PLAN.md file(s). Present current content. Ask user what they want to change. Make targeted edits preserving plan structure (frontmatter, XML tasks, verification). Commit changes.
    - **research**: Load RESEARCH.md. Present sections. Ask what's changed or needs updating. Edit specific sections. Commit.
    - **context**: Load CONTEXT.md. If it exists, present current decisions/scope. If not, offer to create one via discuss-phase flow. Edit and commit.
    - **roadmap**: Load ROADMAP.md. Present phase section. Allow editing goal, success criteria, requirement mapping. Commit.

    Step 5 - Commit: Use `node ./.claude/get-shit-done/bin/gsd-tools.js commit "docs(phase-{N}): revise {artifact-type}" --files {modified-files}`

    **Key design choices (from research):**
    - Edit-phase is a terminal orchestrator — it directly edits files, not spawning other orchestrators
    - Restrict editing to current milestone (per research recommendation, can expand in Phase 4)
    - Preserve existing file structure when editing (don't rewrite entire files, make targeted changes)
    - Always show current content before asking for changes (PM needs context)
  </action>
  <verify>
    1. File exists: `ls .claude/commands/gsd/edit-phase.md` succeeds
    2. File exists: `ls .claude/get-shit-done/workflows/edit-phase.md` succeeds
    3. Command has required frontmatter: `grep "name: gsd:edit-phase" .claude/commands/gsd/edit-phase.md`
    4. Workflow handles all artifact types: `grep -c "plan\|research\|context\|roadmap" .claude/get-shit-done/workflows/edit-phase.md` returns 4+
    5. Workflow references gsd-tools init: `grep "gsd-tools.js init" .claude/get-shit-done/workflows/edit-phase.md`
    6. Workflow includes commit step: `grep "commit" .claude/get-shit-done/workflows/edit-phase.md`
  </verify>
  <done>
    /gsd:edit-phase command and workflow exist. Workflow discovers available artifacts, routes to appropriate editing flow (plan, research, context, roadmap), and commits changes. Requirement WKFL-05 is satisfied.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update help, plan-phase, and gsd-tools.js cross-references</name>
  <files>
    .claude/get-shit-done/workflows/help.md
    .claude/get-shit-done/workflows/plan-phase.md
    .claude/get-shit-done/bin/gsd-tools.js
  </files>
  <action>
    Read each file first, then make targeted updates.

    **1. Update .claude/get-shit-done/workflows/help.md:**
    - Replace the Quick Start step 3 from `/gsd:execute-phase 1` to `/gsd:complete-phase 1` (or remove execution step entirely and replace with "Mark phase complete and auto-advance to next")
    - Replace the core workflow diagram from `new-project -> plan-phase -> execute-phase -> repeat` to `new-project -> plan-phase -> complete-phase -> repeat`
    - Remove the "Execution" section that documents execute-phase and verify-work commands
    - Add a "Phase Completion" section documenting `/gsd:complete-phase {N}` (marks phase complete, validates planning artifacts, auto-advances to next phase or prompts milestone completion)
    - Add an "Editing" section documenting `/gsd:edit-phase {N}` (revise plans, research, context, or roadmap for any phase)
    - Keep all other sections (Project Initialization, Planning, Milestone, Settings, etc.) intact
    - Ensure no remaining references to execute-phase, execute-plan, verify-work, verify-phase, gsd-executor, or gsd-verifier

    **2. Update .claude/get-shit-done/workflows/plan-phase.md:**
    - Find the "Next Steps" / "offer_next" section that mentions `/gsd:execute-phase`
    - Replace with `/gsd:complete-phase {phase}` or guidance that plans are ready for engineering handoff
    - Find any "Output consumed by /gsd:execute-phase" references and update to "Output consumed by engineering team or /gsd:complete-phase"
    - Preserve all other plan-phase logic (this is a planning tool, its core function stays)

    **3. Update .claude/get-shit-done/bin/gsd-tools.js:**
    - Find the error message in the init switch that lists available workflows (~line 4558): `"Available: execute-phase, plan-phase, new-project, ..."`. Remove `execute-phase` and `verify-work` from the available list. Add `complete-phase` if not present.
    - In the MODEL_PROFILES object (~line 128-134), remove or comment out the `gsd-executor` and `gsd-verifier` entries. These model profile lookups are no longer needed.
    - Keep the `init execute-phase` and `init verify-work` case handlers in the switch but have them return a JSON error message: `{ "error": "Workflow removed", "message": "execute-phase has been removed. Use complete-phase instead." }` — this prevents crashes if any old reference tries to init these workflows.

    **Important:** Make minimal, targeted edits. Do not rewrite large sections. The goal is consistency, not restructuring.
  </action>
  <verify>
    1. `grep -c "execute-phase" .claude/get-shit-done/workflows/help.md` returns 0 (no execution references)
    2. `grep -c "verify-work" .claude/get-shit-done/workflows/help.md` returns 0
    3. `grep "complete-phase" .claude/get-shit-done/workflows/help.md` returns matches (new command documented)
    4. `grep "edit-phase" .claude/get-shit-done/workflows/help.md` returns matches (new command documented)
    5. `grep "execute-phase" .claude/get-shit-done/workflows/plan-phase.md` returns 0 matches in next-steps sections
    6. `node .claude/get-shit-done/bin/gsd-tools.js init execute-phase 1 --raw 2>&1` returns JSON with error field (graceful degradation, not crash)
    7. `grep "gsd-executor" .claude/get-shit-done/bin/gsd-tools.js` returns 0 or only in commented/error-handling code
  </verify>
  <done>
    Help workflow documents planning-only commands (complete-phase, edit-phase) with no execution references. Plan-phase next-steps point to complete-phase. gsd-tools.js init gracefully handles removed workflows. All cross-references are consistent with planning-only GSD.
  </done>
</task>

</tasks>

<verification>
- /gsd:edit-phase command exists and routes to artifact editing
- /gsd:help shows planning-only workflow (no execution commands)
- No active workflow or command file references execute-phase as a valid action (tombstones reference it only in "this was removed" context)
- plan-phase completion output references complete-phase, not execute-phase
- gsd-tools.js handles removed workflow inits gracefully
- All 6 WKFL requirements are covered across plans 01-03
</verification>

<success_criteria>
- /gsd:edit-phase command and workflow exist with artifact-aware routing
- Help workflow is fully updated for planning-only GSD
- Plan-phase references updated to complete-phase
- gsd-tools.js cross-references cleaned up
- Zero stale execute-phase/verify-work references in active (non-tombstone) files
</success_criteria>

<output>
After completion, create `.planning/phases/03-workflow-simplification/03-03-SUMMARY.md`
</output>
