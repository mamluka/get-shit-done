---
phase: 05-jira-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/bin/gsd-tools.js
  - get-shit-done/templates/mcp-setup/jira-rovo.md
  - get-shit-done/templates/mcp-setup/jira-community.md
autonomous: true

must_haves:
  truths:
    - "Running `gsd-tools.js check-jira-mcp` returns JSON with available, serverName, and message fields"
    - "MCP check completes within 5 seconds even if Claude CLI is slow or missing"
    - "Check detects any MCP server with 'jira' or 'atlassian' in the name (case-insensitive)"
    - "Setup guide for Atlassian Rovo (Cloud/OAuth) provides step-by-step install instructions"
    - "Setup guide for community mcp-atlassian (Server+DC/API token) provides step-by-step install instructions"
  artifacts:
    - path: "get-shit-done/bin/gsd-tools.js"
      provides: "check-jira-mcp subcommand"
      contains: "check-jira-mcp"
    - path: "get-shit-done/templates/mcp-setup/jira-rovo.md"
      provides: "Setup guide for Atlassian Rovo MCP (Cloud)"
      contains: "claude mcp add"
    - path: "get-shit-done/templates/mcp-setup/jira-community.md"
      provides: "Setup guide for community mcp-atlassian (Server/DC)"
      contains: "mcp-atlassian"
  key_links:
    - from: "get-shit-done/bin/gsd-tools.js"
      to: "claude mcp list"
      via: "execSync CLI call with 5s timeout"
      pattern: "claude mcp list"
---

<objective>
Add a `check-jira-mcp` subcommand to gsd-tools.js that detects whether a Jira MCP server is configured, and create setup guide templates for the two main Jira MCP server options.

Purpose: Provides the building blocks for Phase 5's non-blocking Jira MCP integration. The CLI command enables any workflow to check MCP availability, and the templates give PMs clear setup instructions when Jira MCP is missing.

Output: New `check-jira-mcp` CLI subcommand returning JSON, two setup guide markdown files in templates/mcp-setup/.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-jira-integration/05-RESEARCH.md
@./.claude/get-shit-done/bin/gsd-tools.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add check-jira-mcp subcommand to gsd-tools.js</name>
  <files>get-shit-done/bin/gsd-tools.js</files>
  <action>
Add a new `checkJiraMcp()` function and wire it as the `check-jira-mcp` CLI subcommand in gsd-tools.js. This function detects whether a Jira MCP server is configured by executing `claude mcp list` via `execSync` and searching the output for Jira-related keywords.

**Step 1: Add the checkJiraMcp function**

Place the function near the other utility/detection functions (after the git helper functions, around line 300-400). The function:

```javascript
function checkJiraMcp() {
  try {
    const output = execSync('claude mcp list 2>&1', {
      encoding: 'utf8',
      timeout: 5000,
      stdio: ['pipe', 'pipe', 'pipe']
    });

    // Parse output looking for Jira-related servers
    // CLI output: one server per line
    const lines = output.split('\n').filter(l => l.trim());
    const jiraServer = lines.find(line => {
      const lower = line.toLowerCase();
      return lower.includes('jira') || lower.includes('atlassian');
    });

    if (jiraServer) {
      // Extract server name (format varies: "server-name (type)" or just "server-name")
      const match = jiraServer.match(/^([^\(]+)/);
      const serverName = match ? match[1].trim() : jiraServer.trim();

      return {
        available: true,
        serverName,
        message: 'Jira integration detected: ' + serverName
      };
    }

    return {
      available: false,
      serverName: null,
      message: 'No Jira integration configured'
    };
  } catch (err) {
    // Claude CLI not available, command failed, or timeout
    return {
      available: false,
      serverName: null,
      message: 'Jira integration check skipped',
      reason: err.code === 'ETIMEDOUT' ? 'Check timed out' : 'Claude CLI not available'
    };
  }
}
```

Key design decisions:
- Use `execSync` (already imported at line 121) with 5-second timeout per research recommendation
- Case-insensitive keyword matching for "jira" or "atlassian" to handle custom server names (per Pitfall 4 in research)
- Returns structured JSON with `available`, `serverName`, `message` fields
- Catch block handles: command not found, timeout, parse errors — all gracefully return `available: false`
- User-facing messages use "Jira integration" not "Jira MCP server" (per PM-friendly language decision)

**Step 2: Wire the CLI subcommand**

Add a new case in the main switch statement (around line 5560, near the other standalone commands like `config-set`, `config-ensure-section`):

```javascript
case 'check-jira-mcp': {
  const result = checkJiraMcp();
  output(result, raw);
  break;
}
```

**Step 3: Update the usage/help text**

In the usage string at the top of the file (around line 85-120 where commands are listed), add `check-jira-mcp` to the commands list:

```
 *   check-jira-mcp                      Check if Jira MCP server is configured
```

Place it near the other detection/utility commands.

**IMPORTANT:** Do NOT change any existing function signatures, variable names, or behavior. This is purely additive — one new function and one new case statement.
  </action>
  <verify>
1. `node get-shit-done/bin/gsd-tools.js check-jira-mcp` — returns JSON with `available`, `serverName`, and `message` fields (available will likely be false in dev environment)
2. `node get-shit-done/bin/gsd-tools.js check-jira-mcp --raw` — returns raw JSON
3. `grep -n "check-jira-mcp" get-shit-done/bin/gsd-tools.js` — confirms function and case exist
4. `grep -n "checkJiraMcp" get-shit-done/bin/gsd-tools.js` — confirms function definition
5. Command completes in under 6 seconds (5s timeout + overhead)
  </verify>
  <done>
`check-jira-mcp` subcommand exists in gsd-tools.js. Returns JSON with available (boolean), serverName (string|null), and message (string). Handles missing CLI, timeout, and no-match cases gracefully. Completes within 5 seconds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Jira MCP setup guide templates</name>
  <files>
    get-shit-done/templates/mcp-setup/jira-rovo.md
    get-shit-done/templates/mcp-setup/jira-community.md
  </files>
  <action>
Create the `templates/mcp-setup/` directory and two setup guide files. These are displayed to PMs when Jira MCP is not detected during project creation.

**Step 1: Create directory**

```bash
mkdir -p get-shit-done/templates/mcp-setup
```

**Step 2: Create jira-rovo.md (Atlassian Cloud users)**

Write `get-shit-done/templates/mcp-setup/jira-rovo.md`:

```markdown
# Jira Integration Setup: Atlassian Cloud

For teams using Atlassian Cloud (*.atlassian.net).

## Prerequisites

- Atlassian Cloud account with Jira access
- Claude Code installed and running

## Setup Steps

### 1. Add the Atlassian Rovo MCP Server

Run this command in your terminal:

```bash
claude mcp add --transport http atlassian-rovo https://mcp.atlassian.com/
```

### 2. Authenticate

In Claude Code, type:

```
/mcp
```

Select the `atlassian-rovo` server and follow the OAuth authentication flow. You will be redirected to Atlassian to authorize access.

### 3. Verify

Run this in your terminal to confirm the server is listed:

```bash
claude mcp list
```

You should see `atlassian-rovo` in the output.

## What This Enables

Once configured, GSD can optionally validate planning artifacts against your Jira board:
- Look up existing Jira tickets during requirements definition
- Cross-reference project plans with Jira epics

## Troubleshooting

**"Server not responding"**: Check your internet connection and Atlassian Cloud status at https://status.atlassian.com

**"Authentication failed"**: Re-run `/mcp` in Claude Code and re-authenticate with Atlassian.

**"Server not found after adding"**: Restart Claude Code after adding the MCP server.

---

*This guide is for Atlassian Cloud users. For Jira Server or Data Center, see jira-community.md.*
```

**Step 3: Create jira-community.md (Server/DC users)**

Write `get-shit-done/templates/mcp-setup/jira-community.md`:

```markdown
# Jira Integration Setup: Jira Server / Data Center

For teams using Jira Server or Jira Data Center (self-hosted).

## Prerequisites

- Jira Server or Data Center instance with API access
- Jira API token (generated from your Jira profile)
- Python 3.12+ with `uvx` installed
- Claude Code installed and running

## Setup Steps

### 1. Generate a Jira API Token

1. Log in to your Jira instance
2. Go to your Profile > Security > API Tokens
3. Click "Create API Token"
4. Copy the generated token (you will not see it again)

### 2. Add the Community MCP Server

Run this command in your terminal, replacing the placeholder values:

```bash
claude mcp add --transport stdio mcp-atlassian -- \
  uvx mcp-atlassian \
  --jira-url https://your-jira-instance.example.com \
  --jira-username your-email@example.com \
  --jira-api-token YOUR_API_TOKEN
```

Replace:
- `https://your-jira-instance.example.com` with your Jira URL
- `your-email@example.com` with your Jira login email
- `YOUR_API_TOKEN` with the token from Step 1

### 3. Verify

Run this in your terminal to confirm the server is listed:

```bash
claude mcp list
```

You should see `mcp-atlassian` in the output.

## What This Enables

Once configured, GSD can optionally validate planning artifacts against your Jira board:
- Look up existing Jira tickets during requirements definition
- Cross-reference project plans with Jira epics

## Troubleshooting

**"uvx: command not found"**: Install uvx via `pip install uvx` or `pipx install uvx`. Requires Python 3.12+.

**"Connection refused"**: Verify your Jira URL is correct and accessible from your machine. Check VPN if your Jira is behind a corporate network.

**"Authentication failed"**: Regenerate your API token and update the MCP server configuration.

**"Server not found after adding"**: Restart Claude Code after adding the MCP server.

---

*This guide is for Jira Server/Data Center users. For Atlassian Cloud, see jira-rovo.md.*
```

**Language guidelines:** Both templates use PM-friendly language throughout — no references to "MCP protocol," "JSON-RPC," "stdio transport," or other technical internals. The term "Jira integration" is used consistently (per research Pitfall 5).
  </action>
  <verify>
1. `ls get-shit-done/templates/mcp-setup/` — shows jira-rovo.md and jira-community.md
2. `grep "claude mcp add" get-shit-done/templates/mcp-setup/jira-rovo.md` — confirms install command present
3. `grep "claude mcp add" get-shit-done/templates/mcp-setup/jira-community.md` — confirms install command present
4. `grep -c "MCP protocol\|JSON-RPC\|stdio transport" get-shit-done/templates/mcp-setup/*.md` — zero matches (no technical jargon)
5. Both files are valid markdown (no syntax errors)
  </verify>
  <done>
Two setup guide templates created: jira-rovo.md for Atlassian Cloud (OAuth) and jira-community.md for Jira Server/DC (API token). Both use PM-friendly language, provide step-by-step instructions, include verification steps, and have troubleshooting sections.
  </done>
</task>

</tasks>

<verification>
1. `node get-shit-done/bin/gsd-tools.js check-jira-mcp` returns valid JSON with expected fields
2. Command completes within 6 seconds (including 5s timeout tolerance)
3. `ls get-shit-done/templates/mcp-setup/` shows both template files
4. No existing gsd-tools.js functionality broken — `node get-shit-done/bin/gsd-tools.js` still shows usage
5. No technical MCP jargon in setup guide templates
</verification>

<success_criteria>
- `check-jira-mcp` subcommand returns structured JSON with available/serverName/message
- Command handles missing CLI, timeout, and no-match gracefully (never crashes)
- Both setup guide templates provide complete install instructions
- PM-friendly language throughout (no "MCP server," "JSON-RPC," "stdio")
- Zero changes to existing gsd-tools.js behavior
</success_criteria>

<output>
After completion, create `.planning/phases/05-jira-integration/05-01-SUMMARY.md`
</output>
