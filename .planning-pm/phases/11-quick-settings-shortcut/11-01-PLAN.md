---
phase: 11-quick-settings-shortcut
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/bin/gsd-tools.js
  - get-shit-done/workflows/new-project.md
autonomous: true

must_haves:
  truths:
    - "User sees two equal options (Recommended / Custom) before individual settings questions during new-project"
    - "Choosing Recommended applies all defaults in one action and shows a summary of what was set"
    - "Choosing Custom runs the existing settings flow with zero changes to current behavior"
    - "Recommended settings are defined in a single RECOMMENDED_SETTINGS constant — no value duplication across code paths"
    - "Recommended and interactive flow produce identical config.json output when same values are chosen"
  artifacts:
    - path: "get-shit-done/bin/gsd-tools.js"
      provides: "RECOMMENDED_SETTINGS frozen constant and config-init-recommended subcommand"
      contains: "RECOMMENDED_SETTINGS"
    - path: "get-shit-done/workflows/new-project.md"
      provides: "Round 0 Recommended/Custom gate in Step 6"
      contains: "Recommended"
  key_links:
    - from: "get-shit-done/workflows/new-project.md"
      to: "get-shit-done/bin/gsd-tools.js"
      via: "config-init-recommended subcommand call"
      pattern: "config-init-recommended"
---

<objective>
Add a quick settings shortcut to the new-project workflow so users can apply recommended defaults in one action instead of answering individual settings questions.

Purpose: Streamline the most common path through project setup — most users want the recommended settings, so let them skip 8 individual questions with a single choice.

Output: Modified gsd-tools.js with RECOMMENDED_SETTINGS constant and config-init-recommended subcommand; modified new-project.md with Round 0 gate before existing settings questions.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@get-shit-done/bin/gsd-tools.js
@get-shit-done/workflows/new-project.md
@.planning/phases/11-quick-settings-shortcut/11-CONTEXT.md
@.planning/phases/11-quick-settings-shortcut/11-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add RECOMMENDED_SETTINGS constant and config-init-recommended subcommand to gsd-tools.js</name>
  <files>get-shit-done/bin/gsd-tools.js</files>
  <action>
Add a frozen `RECOMMENDED_SETTINGS` constant near the top of gsd-tools.js (after the existing constants/helpers, before the first command function). This constant is the single source of truth for recommended project settings (SETUP-03).

Define the constant as:

```javascript
const RECOMMENDED_SETTINGS = Object.freeze({
  mode: 'yolo',
  depth: 'standard',
  parallelization: true,
  commit_docs: true,
  model_profile: 'balanced',
  'workflow.research': true,
  'workflow.plan_check': true,
  'workflow.verifier': true,
});
```

Key design decisions per CONTEXT.md locked decisions:
- `depth: 'standard'` (not 'quick' — per user decision)
- `mode: 'yolo'` (matches the current "Recommended" label on that option)
- Dot-notation keys for nested workflow settings (matches cmdConfigSet's dot-notation parsing)
- Object.freeze prevents accidental mutation

Then add a new `config-init-recommended` subcommand that:
1. Loads or creates config.json (same pattern as existing cmdConfigSet)
2. Iterates over RECOMMENDED_SETTINGS entries
3. For each entry, uses the same dot-notation nested key assignment logic as cmdConfigSet (split on '.', traverse/create objects, set leaf value)
4. Writes the complete config.json once (single atomic write, not N separate writes)
5. Returns JSON: `{ applied: true, settings: { ...the flat key-value pairs that were applied } }`
6. On error, returns a helpful error message via the existing error() helper

Register the subcommand in the main switch statement:

```javascript
case 'config-init-recommended': {
  cmdConfigInitRecommended(cwd, raw);
  break;
}
```

The function signature: `function cmdConfigInitRecommended(cwd, raw)`

Implementation pattern — reuse the same config loading/writing pattern as cmdConfigSet but apply all settings in a single pass:

```javascript
function cmdConfigInitRecommended(cwd, raw) {
  const configPath = resolvePlanning(cwd, 'config.json');

  let config = {};
  try {
    if (fs.existsSync(configPath)) {
      config = JSON.parse(fs.readFileSync(configPath, 'utf-8'));
    }
  } catch (err) {
    error('Couldn\'t read project settings. The config file may be corrupted.', err.message);
  }

  // Apply all recommended settings
  for (const [keyPath, value] of Object.entries(RECOMMENDED_SETTINGS)) {
    const keys = keyPath.split('.');
    let current = config;
    for (let i = 0; i < keys.length - 1; i++) {
      const key = keys[i];
      if (current[key] === undefined || typeof current[key] !== 'object') {
        current[key] = {};
      }
      current = current[key];
    }
    current[keys[keys.length - 1]] = value;
  }

  try {
    fs.writeFileSync(configPath, JSON.stringify(config, null, 2), 'utf-8');
    output({ applied: true, settings: { ...RECOMMENDED_SETTINGS } }, raw, 'Recommended settings applied');
  } catch (err) {
    error('Couldn\'t save project settings. Check folder permissions and try again.', err.message);
  }
}
```

Also add a `recommended-settings` subcommand that just returns the constant as JSON (for introspection/testing):

```javascript
case 'recommended-settings': {
  output({ ...RECOMMENDED_SETTINGS }, raw, Object.entries(RECOMMENDED_SETTINGS).map(([k,v]) => `${k}=${v}`).join('\n'));
  break;
}
```

Do NOT modify any existing functions or subcommands. This is purely additive.
  </action>
  <verify>
Run the following commands to verify:

```bash
# Verify constant exists
grep -n "RECOMMENDED_SETTINGS" get-shit-done/bin/gsd-tools.js

# Verify subcommand is registered
grep -n "config-init-recommended" get-shit-done/bin/gsd-tools.js

# Verify recommended-settings subcommand is registered
grep -n "recommended-settings" get-shit-done/bin/gsd-tools.js

# Run the recommended-settings subcommand (should output JSON)
node get-shit-done/bin/gsd-tools.js recommended-settings

# Run existing tests to confirm no regressions
node --test get-shit-done/bin/gsd-tools.test.js
```
  </verify>
  <done>
RECOMMENDED_SETTINGS frozen constant exists in gsd-tools.js with all 8 settings matching CONTEXT.md locked decisions. `config-init-recommended` subcommand applies all settings atomically. `recommended-settings` subcommand returns the constant as JSON. Existing tests pass.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Recommended/Custom gate to new-project workflow Step 6</name>
  <files>get-shit-done/workflows/new-project.md</files>
  <action>
Modify Step 6 ("Workflow Preferences") in new-project.md to add a "Round 0" gate before the existing Round 1 and Round 2 questions.

The modification inserts new content at the START of Step 6, before the existing "Round 1" content. The existing Round 1 and Round 2 content is NOT changed — it is wrapped in a conditional that only runs if the user picks "Custom".

Replace the current Step 6 section (starting from `## 6. Workflow Preferences` up to but not including `## 6.5. Resolve Model Profile`) with:

```markdown
## 6. Workflow Preferences

**Round 0 — Recommended vs Custom:**

Present two equal options. Neither is hidden or secondary. Brief context before the choice.

Use AskUserQuestion:
- header: "Settings"
- question: "We have recommended settings that work well for most projects. You can also configure each setting individually."
- multiSelect: false
- options:
  - { label: "Recommended", description: "Apply balanced defaults — you'll see a summary of what's set" }
  - { label: "Custom", description: "Configure each setting individually" }

**If "Recommended":**

Apply all recommended settings in one action:

```bash
node ~/.claude/get-shit-done/bin/gsd-tools.js config-init-recommended
```

Parse result JSON. If `applied: true`, display the summary:

```
✓ Applied recommended settings:

  Setting          Value
  ───────────────  ────────────
  Mode             YOLO
  Depth            Standard
  Parallelization  Enabled
  Research         Enabled
  Plan Check       Enabled
  Verifier         Enabled
  Model Profile    Balanced
  Commit Docs      Enabled

  You can change these anytime with /gsd:settings
```

If error: Display error message and fall back to Custom flow.

Skip Round 1 and Round 2 entirely. Proceed to Step 6.5 (Resolve Model Profile).

**If "Custom":**

Proceed through existing Round 1 and Round 2 below. No changes to current behavior.

**If auto mode:** Skip Round 0 prompt. Call `config-init-recommended` directly (recommended settings are the auto-mode defaults). Display summary. Proceed to Step 6.5.

**Round 1 — Core workflow settings (4 questions):**
```

Then keep ALL of the existing Round 1 content (the 4 questions block from `questions: [` through the Mode, Depth, Plan Processing, Git Tracking options) EXACTLY as-is.

After the existing Round 1 questions block, keep the existing "**Round 2 — Workflow agents:**" section EXACTLY as-is (Research, Plan Check, Verifier, Model Profile questions).

After the existing Round 2 content, keep the config.json creation block, the commit_docs logic, and the commit config.json block EXACTLY as-is.

The only structural change is:
1. Add Round 0 before Round 1
2. Wrap the execution of Round 1 + Round 2 + config creation in the "If Custom" conditional
3. Add the "If Recommended" path that calls config-init-recommended and shows summary
4. Add auto mode handling at Round 0 level

CRITICAL: Do NOT change the content of the existing Round 1 questions, Round 2 questions, config.json creation block, or commit block. Only add the Round 0 gate and conditional wrapping.
  </action>
  <verify>
Read the modified new-project.md and verify:

1. Step 6 starts with Round 0 (Recommended vs Custom)
2. Round 0 uses AskUserQuestion with two equal options
3. "Recommended" path calls `config-init-recommended` and shows summary table
4. "Custom" path runs existing Round 1 + Round 2 unchanged
5. Auto mode path calls `config-init-recommended` directly
6. Step 6.5 (Resolve Model Profile) is unchanged
7. No existing content was deleted or modified — only new content added and conditional wrapping applied

```bash
# Check for Round 0 presence
grep -n "Round 0" get-shit-done/workflows/new-project.md

# Check for config-init-recommended reference
grep -n "config-init-recommended" get-shit-done/workflows/new-project.md

# Check Round 1 and Round 2 still exist
grep -n "Round 1" get-shit-done/workflows/new-project.md
grep -n "Round 2" get-shit-done/workflows/new-project.md

# Check Step 6.5 still exists
grep -n "6.5. Resolve Model Profile" get-shit-done/workflows/new-project.md
```
  </verify>
  <done>
Step 6 of new-project.md has a Round 0 gate presenting "Recommended" and "Custom" as two equal options. Recommended path calls config-init-recommended and shows a summary table. Custom path runs existing settings flow unchanged. Auto mode applies recommended settings directly. Step 6.5 and all subsequent steps are untouched.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **SETUP-01**: Verify new-project.md Step 6 shows Recommended/Custom choice before individual questions
2. **SETUP-02**: Verify RECOMMENDED_SETTINGS constant contains: mode=yolo, depth=standard, research=true, plan_check=true, verifier=true, model_profile=balanced, commit_docs=true, parallelization=true
3. **SETUP-03**: Verify RECOMMENDED_SETTINGS is defined once as Object.freeze constant — grep should show exactly one definition
4. **No drift**: Verify config-init-recommended uses the same RECOMMENDED_SETTINGS constant (not duplicate values)
5. **Custom unchanged**: Verify Round 1 and Round 2 question blocks are identical to their previous versions
6. **Existing tests pass**: `node --test get-shit-done/bin/gsd-tools.test.js`
</verification>

<success_criteria>
- RECOMMENDED_SETTINGS constant defined once in gsd-tools.js with Object.freeze
- config-init-recommended subcommand applies all settings atomically via single config write
- new-project.md Step 6 presents Recommended/Custom gate before individual questions
- Choosing Recommended skips all individual questions and shows summary
- Choosing Custom runs existing flow with zero changes
- Auto mode applies recommended settings without prompting
- All existing gsd-tools.js tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/11-quick-settings-shortcut/11-01-SUMMARY.md`
</output>
